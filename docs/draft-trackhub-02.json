{
  "$schema": "http://json-schema.org/draft-04/schema#",

  "title": "TrackHub Schema",

  "description" : "",

  "type": "object",

  "properties": {
    "data": {
      "type": "object", 

      "title": "TrackHub Data",

      "description": "Data/metadata for each track: attribute name is track name, attribute value is the track data definition. Exclude hierarchical (i.e. super-,composite-,aggregate-) tracks, which are part of the provided views and then are modelled in the configuration property."

      "patternProperties": {
        "^[a-zA-z][a-zA-Z0-9_]+$": { "$ref": "#/definitions/track_data" }
      },

      "additionalProperties": "false"
    },

    "configuration": {
      "type": "array",

      "title": "TruckHub Configuration",

      "description": "Contains display and configuration properties for the tracks speficied in the data attribute. Also provides the definition of track groupings into set and hierarchies with super-,composite-,aggregate-tracks.",

      "items": { "$ref": "#/definitions/track_configuration" },

      "uniqueItems": true
    }

    "additionalProperties": false
  },

  "required": [ "data", "configuration" ]

  "definitions": {

    "track_data": {
      "title": "Track data/metadata definition.",
      "description": "",
      "oneOf": [
        { "$ref": "#/definitions/generic_track_data" },
	{ "$ref": "#/definitions/epigenomics_track_data" },
	{ "$ref": "#/definitions/proteomics_track_data" }
      ]
      
    },

    "track_configuration": {
      "title": "Track display and configuration properties.",

      "description": "",

      "oneOf": [
	 { "$ref": "#/definitions/bigBed_track" },
	 { "$ref": "#/definitions/bigWig_track" },
	 { "$ref": "#/definitions/bam_track" },
	 { "$ref": "#/definitions/vcfTabix_track" },
	 { "$ref": "#/definitions/super_track" },
	 { "$ref": "#/definitions/composite_track" },
	 { "$ref": "#/definitions/aggregate_track" }
      ]

    },

    "generic_track_data": {
      "type": "object",

      "title": "",
      "description": "",

      "properties": {
        "organism": {
	  "type": "object",

	  "title": "",
	  "description": "",

          "properties": {
	    "taxid": { "type": "integer", "minimum": 0, "exclusiveMinimum": true },
	    "scientific_name": { "type": "string" }
	  }
	  "required": [ "taxid" ]
        },

        "assembly": { 
          "type": "string",
	  "pattern": "^GCA_[0-9]+\.[0-9]+$"
        },

	"bigDataUrl": { "$ref": "#/definitions/bigDataUrl" },
      },

      "required": [ "organism", "assembly", "bigDataUrl" ]
    },

    "epigenomics_track_data": {
      "allOf": [
        { "$ref": "#/definitions/generic_track_data" },
	{
	  "type": "object",
	  "properties": {
	    "molecule": { "type": "string" },
	    "disease": { "type": "string" },
	    "biomaterial_type": { "type": "string" },
	    "sample_ontology_uri": { "type": "string", "format": "uri" },
	    "disease_ontology_uri": { "type": "string", "format": "uri" },
	    "sample_id": { "type": "string" },

	    "line": { "type": "string" },
	    "lineage": { "type": "string" },
	    "differentiation_stage": { "type": "string" },
	    "medium": { "type": "string" },
	    "sex": { "type": "string" },

	    "donor_id": { "type": "string" },
	    "donor_age": { "type": "integer", "minimum": 0, "exclusiveMinimum": false },
	    "donor_health_status": { "type": "string" },
	    "donor_sex": { "type": "string" },
	    "donor_ethnicity": { "type": "string" }

	    "cell_type": { "type": "string" },
	    "culture_conditions": { "type": "string" },

	    "tissue_type": { "type": "string" },
	    "tissue_depot": { "type": "string" },

	    "experiment_type": { "type": "string" },
	    "library_strategy": { "type": "string" },
	    "experiment_id": { "type": "string" },
	    "reference_registry_id": { "type": "string" },
	    "analysis_group": { "type": "string" },
	    "alignment_software": { "type": "string" },
	    "alignment_software_version": { "type": "string" },
	    "analysis_software": { "type": "string" },
	    "analysis_software_version": { "type": "string" }
	  },
	  "additionalProperties": true
	}
      ]
    },

    "proteomics_track_data": {
      "allOf": [
        { "$ref": "#/definitions/generic_track_data" },
	{ "type": "string" }
      ]
    }

  }

}
