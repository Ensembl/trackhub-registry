{
  "$schema": "http://json-schema.org/draft-04/schema#",

  "title": "TruckHub",

  "description" : "Represents the properties of a TruckHub",

  "type": "object",

  "properties": {
    "hub": { 
      "type": "string",
      "description": "A single word name of the directory containing the track hub files. Not displayed to hub users",
      "pattern": "^[a-zA-z0-9]+$"
    },

    "shortLabel": { 
      "type": "string",
      "description": "The short name for the track hub. Displayed as the hub name on the Track Hubs page and the track group name on the browser tracks page",
      "maxLength": 17
    },

    "longLabel": {
      "type": string,
      "description": "A longer descriptive label for the track hub. Displayed in the description field on the Track Hubs page",
      "maxLength": 80
    },

    "email": { 
      "format": "email",
      "description": "The contact to whom questions regarding the track hub should be directed",
    },

    "genomes": {
      "type": "array",
      "description": "The set of genome assemblies this hub contains data for",
      "items" : { "$ref": "#/definitions/assembly" },
      "minItems": 1,
      "uniqueItems": true
    },

    "additionalProperties": { "type": "string" }    
  },

  "required": [""],

  "definitions": {

    "assembly": {
      "type": "object",

      "description": "The container for the display and configuration properties for each track in a particular genome assembly",

      "properties": {
        "id": { 
	  "type": "string",
	  "description": "A tag used to identify the genome assembly"
	},

	"tracks": {
	  "type": "array",
	  "items": { 
	    "oneOf": [
	      "$ref": "#/definitions/bigBed_track",
	      "$ref": "#/definitions/bigWig_track",
	      "$ref": "#/definitions/bam_track",
	      "$ref": "#/definitions/vcfTabix_track",
	      "$ref": "#/definitions/composite_track",
	      "$ref": "#/definitions/super_track",
	      "$ref": "#/definitions/aggregate_track"
	    ]
	  },
	  "minItems": 1,
	  "uniqueItems": true
	}
      }
    },

    "bigBed_track": {
      "allOf": [
        { "$ref": "#/definitions/track" },
	{ "properties": {
	    "type": { 
	      "type": "string", 
	      "pattern": "bigBed" 
	    }, 

	    "standard_fields": {
	      "type": "number",
	      "minimum": 3,
	      "exclusiveMinimum": false,
	      "maximum": 12,
	      "exclusiveMaximum": false,
	    },

	    "non_standard_fields": { "type": "boolean" },

	    "colorByStrand": {
	      "type": "array",

	      "description": "To color items differently by the strand they align to. The first color will be used for plus strand alignments and the second for the minus strand. This setting is incompatible with spectrum and all items on the same strand will have the same color, regardless of the item's score.",

	      "items": [
	        { "$ref": "#/definitions/color" },
		{ "$ref": "#/definitions/color" }
	      ]
	    },

	    "denseCoverage": {
	      "type": "number",

	      "description": "Type bigBed tracks in dense mode do a density plot based on maximum coverage seen at each pixel. The maxVal corresponds to the count at which the plot reaches maximum darkness. If maxVal is 0 then this will be calculated from the data itself.",

	      "minimum": 0
	    },

	    "exonArrows": {
	      "type": "boolean",

	      "description": "On tracks that show exons or blocks within features, exon arrows allow the user to jump to the next exon or block outside the image. Exon arrows are typically shown by default in these types of tracks, with the exception of tracks in the Regulation group. The arrows can be explicitly shown or hidden using this setting. "
	    },

	    "scoreFilter": { "$ref": "#/definitions/scoreFilter" }


	  },
	  "required": []
	}
      ]      
    },

    "bigWig_track": {
      "allOf": [
        { "$ref": "#/definitions/track" },
	{ "properties": {
	  },
	  "required": []
	}
      ]      
    },

    "bam_track": {
      "allOf": [
        { "$ref": "#/definitions/track" },
	{ "properties": {
	  },
	  "required": []
	}
      ]      
    },

    "vcfTabix_track": {
      "allOf": [
        { "$ref": "#/definitions/track" },
	{ "properties": {
	  },
	  "required": []
	}
      ]      
    },

    "composite_track": {},

    "super_track": {},

    "aggregate_track": {},

    "track": {
      "type": "object",

      "description": "Contains display and configuration properties common to all track types.",

      "properties": {
        "name": { "$ref": "#/definitions/name" },

	"shortLabel": { "$ref": "#/definitions/shortLabel" },

	"longLabel": { "$ref": "#/definitions/longLabel" },

	"bigDataUrl": { "$ref": "#/definitions/bigDataUrl" },

	"visibility": { "$ref": "#/definitions/visibility" },

	"boxedCfg": { 
	  "type": "boolean",

	  "description": "Configuration controls can be placed inside a box on the configuration page. This setting is decorative only, but can make a busy page look more cohesive. Not all track types currently support this feature, but the most common types do, including wig, bigWig, bed, and bigBed. DEFAULT: off."
	},

	"color": { 
	  "$ref": "#/definitions/color",

	  "description": "Many track types allow the color of the data displayed in the image to be specified with this setting. The setting accepts red, green and blue values, each in the range of 0-255 and delimited by commas. Though this setting is widely supported, some track types in certain display modes ignore it, such as the EST tracks in dense mode."
	},
	
	"altColor": { 
	  "$ref": "#/definitions/color",

	  "description": "Many track types allow setting a color range that varies from color to altColor. For instance the CpG Island tracks use the altColor setting to display the weaker islands, while the stronger ones are rendered in color. If altColor is not specified, the system will use a color halfway between that specified in the color tag and white instead."
	},

	"chromosomes": {
	  "type": "array",

	  "description": "Some datasets do not contain data for all chromosomes of a genome. When this is true, use this setting to specify the chromosomes that are covered. The system displays a message that no data is available when the user browses chromosomes not included in this list.",

	  "items": { "type": "string" },

	  "minItems": 1,
	  
	  "uniqueItems": true
	},

	"dataVersion": {
	  "type": "string",

	  "description": "Many tracks undergo multiple revisions over time. In some cases, the older versions should be retained, but even if they are not, it can be useful to declare the current version of the track. Use this setting to display a version statement on the track configuration page and item details page of a track."
	},

	"directUrl": {
	  "type": "string",

	  "description": "Link to a details page giving information about that item.",

	  "format": "uri"
	},

	"iframeUrl": { 
	  "type": "string",

	  "description": "This setting allows integrating an external html page into the default details page, as an iframe."
	},

	"iframeOptions": {
	  "type": "string",

	  "description": "When iframeUrl is used, this statement specifies a string that is inserted literally into the HTML <iframe> tag. It can include options needed for iframe formatting, like width, height, scrolling, etc. If the statement is not present, the default is width='100%' height='1024'."
	},

	"otherDb": {
	  "type": "string",

	  "description": "Track types that show pairwise alignments often need to declare the other species/assembly included in the alignment."
	},

	"pennantIcon": {
	  "type": "object",

	  "description": "Certain tracks can be visually flagged in the Browser by use of an icon and a link to a description of the icon's meaning. The icon is displayed next to the track's short label in the track groups section below the Browser image, and on the track's description and configuration pages. This setting has three parts: 1. icon: currently must refer to an icon in the Browser's images directory in the Browser source tree; 2. a relative or full html path to a description document explaining the icon's meaning. This page displays when the user clicks on the icon; 3. tip: a quoted string tip that will be seen when the user's mouse pointer hovers over the icon.",

	  "properties": {
	    "icon": { "type": "string", "format": "uri" },
	    "html": { "type": "string", "format": "uri" },
	    "tip": { "type": "string" }
	  }
	},

	"priority": {
	  "type": "number",

	  "description": "The priority is used to define the order of a track within its track group or data hub, as well as its default order within the Browser image. The order within the image can be dynamically changed by the user and will always depend upon which other tracks are currently visible. Typically the priority is set only for tracks that are on by default in order to move them ahead of other tracks. Prioritized tracks within a group or data hub are displayed in ascending priority order, followed by unprioritized tracks sorted alphabetically by short label. Tracks of the same priority within a group or hub are sorted by short label. Priority is a floating point number. Default: 0."
	},

	"url": {
	  "type": "string",

	  "description": "Many tracks allow an external link when an individual track data item is examined. Use this setting to put a link to an external URL on the details page. The default prompt the user will see for this url is "outside link:". Use urlLabel to provide a more informative prompt.",

	  "format": "uri"
	},

	"urlLabel": { "type": "string" },

	"urls": {
	  "$ref": "#/definitions/fields_urls",

	  "description": "This is similar to the url tag, but allows urls on fields that are not the "name" field. Use this statement if you need multiple linkouts on the details page or if your linkout is not based on the name field."
	}
      },

      "required": [ "name", "shortLabel", "longLabel", "bigDataUrl", "visibility" ]
    },

    "name": {
      "type": "string",
      
      "definition": "The symbolic name of the track. This is the name of the dataset and must be unique within the Genome Browser or dataHub.",

      "pattern": "^[a-zA-z][a-zA-Z0-9_]+$"
    },

    "type": {
      "type": "string",

      "enum": [ "bam", "bigBed", "bigWig", "vcfTabix"],

      "description": "Declares the format of the data and is used to determine display methods and options. In many cases the type setting includes additional parameters to further specify the data format."
    },

    "shortLabel": {
      "type": "string",

      "definition": "Specifies the track's "short label", which is used in a number of places in the Browser to identify the track.",

      "maxLength": 17
    },

    "longLabel": {
      "type": "string",

      "definition": "Specifies the track's "long label", which is also used in numerous places in the Browser to identify a track. This label should be descriptive enough to allow users to uniquely identify the track within the Browser.",

      "maxLength": 76
    },

    "bigDataUrl": {
      "type": "string",

      "description": "The location of a remote data file containing the bulk of the data for the track. The setting is either the full URL (including http: or another protocol) or it is relative to the directory in which the trackDb file containing this setting is located. The file must be in one of the supported remote data file formats: bam, bigBed, bigWig or vcfTabix. Note that bam and vcfTabix types require a separate index file that must have the same name as the data file plus a standard suffix (".bai" and ".tbi" respectively).",

      "format": "uri"
    },   

    "visibility": {
      "enum": [ "hide", "dense", "squish", "pack", "full" ],

      "description": "Visibility (i.e. "display mode") specifies which of 5 modes (including 'hide') should be used to display the track within the Browser image. This setting is almost always dynamically customizable by each user. The exact configuration of the display for each mode depends upon the track's type, and some modes may not be supported for certain track types. Valid settigs: 1. hide: DEFAULT. The track is not displayed in the Browser image unless the user changes the display setting; 2. dense: The track is displayed as a single line or ribbon. In many cases multiple items are summarized or drawn on top of one another, and the long labels are not displayed; 3. squish: Each item is drawn individually, but at half height and without a label. (Not supported for all types.); 4. pack: Items are displayed individually at full height, but in a much more compact vertical space than in full mode. (Not supported for all types.); 5. full: Each item is displayed as a separate line in the Browser image. Graphed signals may be displayed in varying heights."
    },

    "color_code": {
      "type": "integer",

      "minimum": 0,
      "exclusiveMinimum": false,

      "maximum": 255,
      "exclusiveMaximum": false
    },

    "color": {
      "type": "object",

      "description": "Specifies a color as red, green, blue values",

      "properties": {
        "red": { "$ref": "#/definitions/color_code" },
	"green": { "$ref": "#/definitions/color_code" },
	"blue": { "$ref": "#/definitions/color_code" },
      }
    },

    "fields_urls": {
      "type": "array",

      "items": {
        "type": "object",

	"properties": {
	  "field": { "type": "string" },
	  "url": { "type": "string", "format": "uri" }
	}
      },

      "minItems": 1,
      "uniqueItems": true
    }

  }

}